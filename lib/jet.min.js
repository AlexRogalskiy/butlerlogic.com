function _classPrivateFieldLooseBase(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id=0;function _classPrivateFieldLooseKey(e){return"__private_"+id+++"_"+e}class EventManager{constructor(e,t){var{on:s={},once:a={}}=t;Object.defineProperty(this,_context,{writable:!0,value:void 0}),Object.defineProperty(this,_on,{writable:!0,value:{}}),Object.defineProperty(this,_once,{writable:!0,value:{}}),Object.defineProperty(this,_typeof,{writable:!0,value:e=>Array.isArray(e)?"array":typeof e}),Object.defineProperty(this,_applyNamespace,{writable:!0,value:e=>{var{namespace:t}=_classPrivateFieldLooseBase(this,_context)[_context];return t?"".concat(t,".").concat(e):e}}),_classPrivateFieldLooseBase(this,_context)[_context]=e,_classPrivateFieldLooseBase(this,_on)[_on]=s,_classPrivateFieldLooseBase(this,_once)[_once]=a}initialize(){for(var e in _classPrivateFieldLooseBase(this,_on)[_on])this.on(e,_classPrivateFieldLooseBase(this,_on)[_on][e]);for(var t in _classPrivateFieldLooseBase(this,_once)[_once])this.once(t,_classPrivateFieldLooseBase(this,_once)[_once][t])}emit(){arguments[0]=_classPrivateFieldLooseBase(this,_applyNamespace)[_applyNamespace](arguments[0]),NGN.BUS.emit(...arguments)}on(e,t){if("object"===_classPrivateFieldLooseBase(this,_typeof)[_typeof](t))return this.pool(...arguments);var s=_classPrivateFieldLooseBase(this,_context)[_context];NGN.BUS.on(_classPrivateFieldLooseBase(this,_applyNamespace)[_applyNamespace](e),(function(){t.call(s,...arguments)}))}once(e,t){if("object"===_classPrivateFieldLooseBase(this,_typeof)[_typeof](e))return this.pool(...arguments);var s=_classPrivateFieldLooseBase(this,_context)[_context];NGN.BUS.once(_classPrivateFieldLooseBase(this,_applyNamespace)[_applyNamespace](e),(function(){t.call(s,...arguments)}))}pool(e,t){if("object"===_classPrivateFieldLooseBase(this,_typeof)[_typeof](e)&&(t=e,e=""),NGN.isFn(t))return this.on(e,t);if("object"!==_classPrivateFieldLooseBase(this,_typeof)[_typeof](t))return console.error('Invalid event configuration type "'.concat(_classPrivateFieldLooseBase(this,_typeof)[_typeof](t),'"'));for(var s in t)this.pool("".concat(e,".").concat(s),t[s])}}var _context=_classPrivateFieldLooseKey("context"),_on=_classPrivateFieldLooseKey("on"),_once=_classPrivateFieldLooseKey("once"),_typeof=_classPrivateFieldLooseKey("typeof"),_applyNamespace=_classPrivateFieldLooseKey("applyNamespace");function _classPrivateFieldLooseBase$1(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$1=0;function _classPrivateFieldLooseKey$1(e){return"__private_"+id$1+++"_"+e}class PropertyManager{constructor(e,t){Object.defineProperty(this,_context$1,{writable:!0,value:void 0}),Object.defineProperty(this,_cfg,{writable:!0,value:null}),Object.defineProperty(this,_model,{writable:!0,value:new NGN.DATA.Model({autoid:!0,fields:{}})}),Object.defineProperty(this,_properties,{writable:!0,value:null}),_classPrivateFieldLooseBase$1(this,_context$1)[_context$1]=e,_classPrivateFieldLooseBase$1(this,_cfg)[_cfg]=NGN.coalesce(t,null)}get properties(){var e=this,{data:t}=_classPrivateFieldLooseBase$1(this,_properties)[_properties],s={},a=function(t){Object.defineProperty(s,t,{get:()=>_classPrivateFieldLooseBase$1(e,_properties)[_properties][t],set:s=>_classPrivateFieldLooseBase$1(e,_properties)[_properties][t]=s})};for(var r in t)a(r);return s}get(e){return _classPrivateFieldLooseBase$1(this,_properties)[_properties][e]}initialize(){for(var e in _classPrivateFieldLooseBase$1(this,_properties)[_properties]=new(_classPrivateFieldLooseBase$1(this,_model)[_model]),_classPrivateFieldLooseBase$1(this,_cfg)[_cfg])_classPrivateFieldLooseBase$1(this,_properties)[_properties].addField(e,_classPrivateFieldLooseBase$1(this,_cfg)[_cfg][e]);_classPrivateFieldLooseBase$1(this,_properties)[_properties].on("field.update",e=>{e.old!==e.new&&(_classPrivateFieldLooseBase$1(this,_context$1)[_context$1].emit("property.changed",{property:e.field,old:e.old,new:e.new}),_classPrivateFieldLooseBase$1(this,_context$1)[_context$1].emit("property.".concat(e.field,".changed"),{old:e.old,new:e.new}))})}}var _context$1=_classPrivateFieldLooseKey$1("context"),_cfg=_classPrivateFieldLooseKey$1("cfg"),_model=_classPrivateFieldLooseKey$1("model"),_properties=_classPrivateFieldLooseKey$1("properties");function _classPrivateFieldLooseBase$2(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$2=0;function _classPrivateFieldLooseKey$2(e){return"__private_"+id$2+++"_"+e}class Route{constructor(e){Object.defineProperty(this,_path,{writable:!0,value:null}),Object.defineProperty(this,_hash,{writable:!0,value:null}),Object.defineProperty(this,_query,{writable:!0,value:{}}),Object.defineProperty(this,_processCfg,{writable:!0,value:e=>{"string"!=typeof e?(_classPrivateFieldLooseBase$2(this,_path)[_path]=e.path?_classPrivateFieldLooseBase$2(this,_processPath)[_processPath](e.path):null,_classPrivateFieldLooseBase$2(this,_hash)[_hash]=e.hash?_classPrivateFieldLooseBase$2(this,_processHash)[_processHash](e.hash):null,_classPrivateFieldLooseBase$2(this,_query)[_query]=e.query?_classPrivateFieldLooseBase$2(this,_processQuery)[_processQuery](e.query):{}):_classPrivateFieldLooseBase$2(this,_path)[_path]=e}}),Object.defineProperty(this,_processPath,{writable:!0,value:e=>e?"string"!=typeof e?(console.error("Invalid route path. Exected string, received ".concat(NGN.typeof(e))),null):e:null}),Object.defineProperty(this,_processHash,{writable:!0,value:e=>{if(!e)return null;var t=NGN.typeof(e);return["string","number"].includes(t)?e:(console.error("Invalid route hash. Exected string, received ".concat(t)),null)}}),Object.defineProperty(this,_processQuery,{writable:!0,value:e=>{if(!e)return{};var t=NGN.typeof(e);if("object"!==t)return console.error("Invalid route query configuration: Expected object, received ".concat(t,".")),{};var s={};for(var a in e)[null,void 0].includes(e[a])||(s[a]=e[a]);return s}}),_classPrivateFieldLooseBase$2(this,_processCfg)[_processCfg](e)}get path(){return _classPrivateFieldLooseBase$2(this,_path)[_path]}get hash(){return _classPrivateFieldLooseBase$2(this,_hash)[_hash]}get query(){return _classPrivateFieldLooseBase$2(this,_query)[_query]}resolve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Object.assign({query:_classPrivateFieldLooseBase$2(this,_query)[_query],hash:_classPrivateFieldLooseBase$2(this,_hash)[_hash]},e);var t="".concat(this.resolvePath(NGN.coalesce(e.map))).concat(this.resolveQuery(NGN.coalesce(e.query))).concat(this.resolveHash(NGN.coalesce(e.hash)));return t.startsWith("/")?t:"/".concat(t)}matches(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return!this.path&&!!this.hash&&"#".concat(this.hash)===e}resolveHash(e){return(e=NGN.coalesce(e,this.hash))?"#".concat(e):""}resolveQuery(e){return e=Object.assign({},this.query,e),Object.keys(e).map((t,s)=>"".concat(0===s?"?":"&").concat(t,"=").concat(e[t])).join("")}resolvePath(e){return e&&this.path?"/"+this.path.split("/").filter(Boolean).map(t=>t.startsWith(":")?e[t.substring(1)]||console.error('Route object does not contain a property called "'.concat(t.substring(1),'"')):t).join("/"):NGN.coalesce(this.path,"")}}var _path=_classPrivateFieldLooseKey$2("path"),_hash=_classPrivateFieldLooseKey$2("hash"),_query=_classPrivateFieldLooseKey$2("query"),_processCfg=_classPrivateFieldLooseKey$2("processCfg"),_processPath=_classPrivateFieldLooseKey$2("processPath"),_processHash=_classPrivateFieldLooseKey$2("processHash"),_processQuery=_classPrivateFieldLooseKey$2("processQuery");function _classPrivateFieldLooseBase$3(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$3=0;function _classPrivateFieldLooseKey$3(e){return"__private_"+id$3+++"_"+e}class State{constructor(e,t){Object.defineProperty(this,_id,{writable:!0,value:void 0}),Object.defineProperty(this,_route,{writable:!0,value:void 0}),Object.defineProperty(this,_typeof$1,{writable:!0,value:e=>Array.isArray(e)?"array":typeof e}),Object.defineProperty(this,_getHandler,{writable:!0,value:(e,t)=>{if(!e.hasOwnProperty(t))return null;if("function"!==_classPrivateFieldLooseBase$3(this,_typeof$1)[_typeof$1](e[t]))return null;var s=e[t];return"once"===t?{called:!1,callback:s}:s}}),_classPrivateFieldLooseBase$3(this,_id)[_id]=NGN.DATA.util.GUID(),this.name=e,_classPrivateFieldLooseBase$3(this,_route)[_route]=t.route?new Route(t.route):null;var s=_classPrivateFieldLooseBase$3(this,_typeof$1)[_typeof$1](t);if("function"!==s){if("object"!==s)return console.error('State "'.concat(e,'": Invalid type [').concat(s,"]. State configurations must be defined as either functions or objects."));this.transitions=NGN.coalesce(t.transitions,{}),this.on=_classPrivateFieldLooseBase$3(this,_getHandler)[_getHandler](t,"on"),this.off=_classPrivateFieldLooseBase$3(this,_getHandler)[_getHandler](t,"off"),this.once=_classPrivateFieldLooseBase$3(this,_getHandler)[_getHandler](t,"once")}else this.on=t}get id(){return _classPrivateFieldLooseBase$3(this,_id)[_id]}get route(){return _classPrivateFieldLooseBase$3(this,_route)[_route]}get hasRoute(){return!!_classPrivateFieldLooseBase$3(this,_route)[_route]}hasTransition(e){return this.transitions.hasOwnProperty(e)}getTransition(e){return this.hasTransition(e)?this.transitions[e]:console.error('"'.concat(e,'" is not a valid transition on the "').concat(this.name,'" state'))}}var _id=_classPrivateFieldLooseKey$3("id"),_route=_classPrivateFieldLooseKey$3("route"),_typeof$1=_classPrivateFieldLooseKey$3("typeof"),_getHandler=_classPrivateFieldLooseKey$3("getHandler");function _classPrivateFieldLooseBase$4(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$4=0;function _classPrivateFieldLooseKey$4(e){return"__private_"+id$4+++"_"+e}class StateManager{constructor(e,t,s){for(var a in Object.defineProperty(this,_context$2,{writable:!0,value:null}),Object.defineProperty(this,_states,{writable:!0,value:{}}),Object.defineProperty(this,_current,{writable:!0,value:null}),Object.defineProperty(this,_previous,{writable:!0,value:null}),Object.defineProperty(this,_initialState,{writable:!0,value:null}),Object.defineProperty(this,_payload,{writable:!0,value:null}),Object.defineProperty(this,_routeCfg,{writable:!0,value:null}),Object.defineProperty(this,_hasRoutes,{writable:!0,value:!1}),Object.defineProperty(this,_listeningForPopstate,{writable:!0,value:!1}),Object.defineProperty(this,_initialWindowLocation,{writable:!0,value:void 0}),Object.defineProperty(this,_typeof$2,{writable:!0,value:e=>Array.isArray(e)?"array":typeof e}),Object.defineProperty(this,_applyPopstateListener,{writable:!0,value:()=>{window.addEventListener("popstate",e=>{if(!e.state)return _classPrivateFieldLooseBase$4(this,_execChange)[_execChange](_classPrivateFieldLooseBase$4(this,_initialState)[_initialState]);var{name:t,id:s}=e.state;_classPrivateFieldLooseBase$4(this,_hasId)[_hasId](s)&&_classPrivateFieldLooseBase$4(this,_execChange)[_execChange](_classPrivateFieldLooseBase$4(this,_states)[_states][t])}),_classPrivateFieldLooseBase$4(this,_listeningForPopstate)[_listeningForPopstate]=!0}}),Object.defineProperty(this,_execChange,{writable:!0,value:e=>{var t=new NGN.Tasks;if(t.on("complete",()=>{if(_classPrivateFieldLooseBase$4(this,_previous)[_previous]=NGN.coalesce(_classPrivateFieldLooseBase$4(this,_current)[_current]),_classPrivateFieldLooseBase$4(this,_current)[_current]=e,_classPrivateFieldLooseBase$4(this,_previous)[_previous])return _classPrivateFieldLooseBase$4(this,_context$2)[_context$2].emit("state.changed",{old:_classPrivateFieldLooseBase$4(this,_previous)[_previous].name,new:_classPrivateFieldLooseBase$4(this,_current)[_current].name},_classPrivateFieldLooseBase$4(this,_payload)[_payload]);_classPrivateFieldLooseBase$4(this,_context$2)[_context$2].emit("state.initialized",{old:null,new:_classPrivateFieldLooseBase$4(this,_current)[_current].name},_classPrivateFieldLooseBase$4(this,_payload)[_payload])}),_classPrivateFieldLooseBase$4(this,_current)[_current]){var{name:s,off:a}=_classPrivateFieldLooseBase$4(this,_current)[_current];t.add("Firing state change event...",t=>{_classPrivateFieldLooseBase$4(this,_context$2)[_context$2].emit("state.change",{current:s,next:e.name},_classPrivateFieldLooseBase$4(this,_payload)[_payload]),t()}),a&&t.add("Running previous state off callback...",e=>{a.call(_classPrivateFieldLooseBase$4(this,_context$2)[_context$2],s,_classPrivateFieldLooseBase$4(this,_payload)[_payload]),e()})}e.on&&t.add('Initializing "'.concat(e.name,'" state'),t=>{e.on.call(_classPrivateFieldLooseBase$4(this,_context$2)[_context$2],_classPrivateFieldLooseBase$4(this,_current)[_current]?_classPrivateFieldLooseBase$4(this,_current)[_current].name:null,_classPrivateFieldLooseBase$4(this,_payload)[_payload]),t()}),e.once&&t.add('Running "'.concat(e.name,'" state once-only callback'),t=>{if(e.once.called)return t();e.once.called=!0,e.once.callback.call(_classPrivateFieldLooseBase$4(this,_context$2)[_context$2],_classPrivateFieldLooseBase$4(this,_current)[_current]?_classPrivateFieldLooseBase$4(this,_current)[_current].name:null,_classPrivateFieldLooseBase$4(this,_payload)[_payload]),t()}),t.run(!0)}}),Object.defineProperty(this,_getMatchingState,{writable:!0,value:e=>{var{pathname:t,hash:s}=e,a=Object.keys(_classPrivateFieldLooseBase$4(this,_states)[_states]).find(e=>{var{route:a}=_classPrivateFieldLooseBase$4(this,_states)[_states][e];return!!a&&a.matches(t,s)});return a?Array.isArray(a)?(console.warn('Multiple states found with routes matching "'.concat(t).concat(s,'"')),_classPrivateFieldLooseBase$4(this,_states)[_states][a[0]]):_classPrivateFieldLooseBase$4(this,_states)[_states][a]:null}}),Object.defineProperty(this,_hasId,{writable:!0,value:e=>Object.values(_classPrivateFieldLooseBase$4(this,_states)[_states]).some(t=>t.id===e)}),_classPrivateFieldLooseBase$4(this,_context$2)[_context$2]=NGN.coalesce(e),t)this.add(a,t[a]);_classPrivateFieldLooseBase$4(this,_states)[_states].hasOwnProperty("idle")||(_classPrivateFieldLooseBase$4(this,_states)[_states].idle=new State("idle",(function(){}))),_classPrivateFieldLooseBase$4(this,_initialState)[_initialState]=_classPrivateFieldLooseBase$4(this,_states)[_states][NGN.coalesce(s,"idle")]}get current(){return _classPrivateFieldLooseBase$4(this,_current)[_current]}set current(e){if(!(e=NGN.coalesce(this.get(e))))return _classPrivateFieldLooseBase$4(this,_payload)[_payload]=null,console.error('State "'.concat(e,'" not found'));if(!e.hasRoute)return _classPrivateFieldLooseBase$4(this,_execChange)[_execChange](e);var t={name:e.name,id:e.id,path:e.route.resolve(_classPrivateFieldLooseBase$4(this,_routeCfg)[_routeCfg]),data:NGN.coalesce(Object.assign({map:{},hash:e.route.hash,query:e.route.query},_classPrivateFieldLooseBase$4(this,_routeCfg)[_routeCfg]))};return window.history.state&&window.history.state.path===t.path?void 0:(window.history.pushState(t,t.name,t.path),dispatchEvent(new PopStateEvent("popstate",{state:t})))}get previous(){return _classPrivateFieldLooseBase$4(this,_previous)[_previous]}get states(){return Object.keys(_classPrivateFieldLooseBase$4(this,_states)[_states])}add(e,t){if(this.has(e))return console.error('State "'.concat(e,'" already exists'));var s=_classPrivateFieldLooseBase$4(this,_typeof$2)[_typeof$2](t);if("object"!==s&&"function"!==s)return console.error('Invalid state configuration type "'.concat(s,'"'));var a=new State(e,t);if(_classPrivateFieldLooseBase$4(this,_states)[_states][e]=a,a.hasRoute&&(_classPrivateFieldLooseBase$4(this,_hasRoutes)[_hasRoutes]=!0,_classPrivateFieldLooseBase$4(this,_listeningForPopstate)[_listeningForPopstate]||_classPrivateFieldLooseBase$4(this,_applyPopstateListener)[_applyPopstateListener](),window.location===_classPrivateFieldLooseBase$4(this,_initialWindowLocation)[_initialWindowLocation])){var r=_classPrivateFieldLooseBase$4(this,_getMatchingState)[_getMatchingState](window.location);r&&r.id!==_classPrivateFieldLooseBase$4(this,_current)[_current].id&&_classPrivateFieldLooseBase$4(this,_execChange)[_execChange](r)}}get(e){return this.has(e)?_classPrivateFieldLooseBase$4(this,_states)[_states][e]:console.error('State "'.concat(e,'" not found.'))}has(e){return _classPrivateFieldLooseBase$4(this,_states)[_states].hasOwnProperty(e)}initialize(){_classPrivateFieldLooseBase$4(this,_initialWindowLocation)[_initialWindowLocation]=window.location,_classPrivateFieldLooseBase$4(this,_hasRoutes)[_hasRoutes]&&_classPrivateFieldLooseBase$4(this,_applyPopstateListener)[_applyPopstateListener](),_classPrivateFieldLooseBase$4(this,_execChange)[_execChange](NGN.coalesce(_classPrivateFieldLooseBase$4(this,_getMatchingState)[_getMatchingState](window.location),_classPrivateFieldLooseBase$4(this,_initialState)[_initialState]))}remove(e){return this.has(e)?"idle"===e?console.error("Cannot remove idle state."):(this.current.name===e&&(console.warn('"'.concat(e,'" is the currently active state. Reverting to idle state...')),this.current="idle"),void delete _classPrivateFieldLooseBase$4(this,_states)[_states][e]):console.error('State "'.concat(e,'" does not exist.'))}transition(e,t,s){switch(e=_classPrivateFieldLooseBase$4(this,_current)[_current].getTransition(e),_classPrivateFieldLooseBase$4(this,_typeof$2)[_typeof$2](e)){case"string":return _classPrivateFieldLooseBase$4(this,_payload)[_payload]=t,_classPrivateFieldLooseBase$4(this,_routeCfg)[_routeCfg]=s,void(this.current=e);case"function":return e.call(_classPrivateFieldLooseBase$4(this,_context$2)[_context$2],t,s);default:throw new Error("Invalid Transition Configuration")}}setState(e,t){if("string"!==_classPrivateFieldLooseBase$4(this,_typeof$2)[_typeof$2](e))return console.error('Invalid state identifier type "'.concat(_classPrivateFieldLooseBase$4(this,_typeof$2)[_typeof$2](e),'"'));_classPrivateFieldLooseBase$4(this,_payload)[_payload]=t,this.current=e}}var _Symbol$iterator,_Symbol$toStringTag,_context$2=_classPrivateFieldLooseKey$4("context"),_states=_classPrivateFieldLooseKey$4("states"),_current=_classPrivateFieldLooseKey$4("current"),_previous=_classPrivateFieldLooseKey$4("previous"),_initialState=_classPrivateFieldLooseKey$4("initialState"),_payload=_classPrivateFieldLooseKey$4("payload"),_routeCfg=_classPrivateFieldLooseKey$4("routeCfg"),_hasRoutes=_classPrivateFieldLooseKey$4("hasRoutes"),_listeningForPopstate=_classPrivateFieldLooseKey$4("listeningForPopstate"),_initialWindowLocation=_classPrivateFieldLooseKey$4("initialWindowLocation"),_typeof$2=_classPrivateFieldLooseKey$4("typeof"),_applyPopstateListener=_classPrivateFieldLooseKey$4("applyPopstateListener"),_execChange=_classPrivateFieldLooseKey$4("execChange"),_getMatchingState=_classPrivateFieldLooseKey$4("getMatchingState"),_hasId=_classPrivateFieldLooseKey$4("hasId");class Utilities{static elementIsVisible(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=e.getBoundingClientRect(),a=s.bottom>=0&&s.right>=0;return t?a:a&&s.top>=0&&s.left>=0&&s.height<=document.documentElement.clientHeight&&s.width<=document.documentElement.clientWidth}static createGUID(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);var s=4294967295*Math.random()|0,a=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return e[255&s]+e[s>>8&255]+e[s>>16&255]+e[s>>24&255]+"-"+e[255&a]+e[a>>8&255]+"-"+e[a>>16&15|64]+e[a>>24&255]+"-"+e[63&r|128]+e[r>>8&255]+"-"+e[r>>16&255]+e[r>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]}}class Reference{constructor(e){if(this.element=NGN.coalesce(e),this.element)return new Proxy(this,{get:(e,t)=>t in e.element?Reflect.get(e.element,t):Reflect.get(e,t),set:(e,t,s)=>t in e.element?Reflect.set(e.element,t,s):Reflect.set(e,t,s)})}on(e,t){this.element.addEventListener(...arguments)}off(e,t){this.element.removeEventListener(...arguments)}destroy(){if(!this.element)return console.error("Reference element does not exist");this.element.parentNode.removeChild(element)}}function _classPrivateFieldLooseBase$5(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$5=0;function _classPrivateFieldLooseKey$5(e){return"__private_"+id$5+++"_"+e}_Symbol$iterator=Symbol.iterator,_Symbol$toStringTag=Symbol.toStringTag;class JetReferenceCollection{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(Object.defineProperty(this,_references,{writable:!0,value:void 0}),"array"!==NGN.typeof(e))return console.error('Invalid argument type "'.concat(NGN.typeof(e),'". JetReferenceCollection expects an array.'));_classPrivateFieldLooseBase$5(this,_references)[_references]=e,_classPrivateFieldLooseBase$5(this,_references)[_references].forEach((e,t)=>{this[t]=e,e.id&&(this[e.id]=e)})}get length(){return _classPrivateFieldLooseBase$5(this,_references)[_references].length}forEach(e){_classPrivateFieldLooseBase$5(this,_references)[_references].forEach(e)}item(e){return this[e]}namedItem(e){var t=_classPrivateFieldLooseBase$5(this,_references)[_references].filter(t=>t.id===e||t.name===e);return t.length>0?t[0]:null}[_Symbol$iterator](){var e=0;return{next:()=>{var t={value:this[e],done:!(e in this)};return e++,t}}}[_Symbol$toStringTag](){return"JetReferenceCollection"}}var _references=_classPrivateFieldLooseKey$5("references");function _classPrivateFieldLooseBase$6(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$6=0;function _classPrivateFieldLooseKey$6(e){return"__private_"+id$6+++"_"+e}class ReferenceManager{constructor(e,t){var s=this;for(var a in Object.defineProperty(this,_context$3,{writable:!0,value:void 0}),Object.defineProperty(this,_cfg$1,{writable:!0,value:void 0}),Object.defineProperty(this,_self,{writable:!0,value:void 0}),Object.defineProperty(this,_handlers,{writable:!0,value:new Map}),Object.defineProperty(this,_reservedNames,{writable:!0,value:["add","remove","self"]}),Object.defineProperty(this,_applyContext,{writable:!0,value:e=>"".concat(_classPrivateFieldLooseBase$6(this,_context$3)[_context$3].selector?"".concat(_classPrivateFieldLooseBase$6(this,_context$3)[_context$3].selector," "):"").concat(e)}),Object.defineProperty(this,_referenceIsValid,{writable:!0,value:(e,t)=>{var s=NGN.typeof(t);return"string"!==s?(console.error('Invalid reference "'.concat(e,'". Expected selector string but got "').concat(s,'"')),!1):!_classPrivateFieldLooseBase$6(this,_reservedNames)[_reservedNames].includes(e)||(console.error('Invalid reference "'.concat(e,'". "').concat(e,'" is a reserved word')),!1)}}),Object.defineProperty(this,_registerHandler,{writable:!0,value:function(e,t,a,r){arguments.length>4&&void 0!==arguments[4]&&arguments[4];var i={event:a,type:t,callback:r};if(!_classPrivateFieldLooseBase$6(s,_handlers)[_handlers].has(e))return _classPrivateFieldLooseBase$6(s,_handlers)[_handlers].set(e,[i]);var o=_classPrivateFieldLooseBase$6(s,_handlers)[_handlers].get(e);o.some(e=>e.callback===r)||o.push(i)}}),Object.defineProperty(this,_unregisterHandler,{writable:!0,value:(e,t,s)=>{if(!_classPrivateFieldLooseBase$6(this,_handlers)[_handlers].has(e))return console.error("Reference element not found");var a=_classPrivateFieldLooseBase$6(this,_handlers)[_handlers].get(e).filter(e=>e.callback!==s);if(0===a.length)return _classPrivateFieldLooseBase$6(this,_handlers)[_handlers].delete(e);_classPrivateFieldLooseBase$6(this,_handlers)[_handlers].set(e,a)}}),Object.defineProperty(this,_unregisterAllHandlers,{writable:!0,value:e=>_classPrivateFieldLooseBase$6(this,_handlers)[_handlers].delete(e)}),_classPrivateFieldLooseBase$6(this,_context$3)[_context$3]=e,t=NGN.coalesce(t,{}))_classPrivateFieldLooseBase$6(this,_referenceIsValid)[_referenceIsValid](a,t[a])||delete t[a];"TemplateInstance"!==_classPrivateFieldLooseBase$6(this,_context$3)[_context$3].constructor.name&&(t=Object.assign(t,{self:_classPrivateFieldLooseBase$6(this,_context$3)[_context$3].selector})),_classPrivateFieldLooseBase$6(this,_cfg$1)[_cfg$1]=t}initialize(e){e&&(_classPrivateFieldLooseBase$6(this,_self)[_self]=e),_classPrivateFieldLooseBase$6(this,_handlers)[_handlers].clear()}get length(){return Object.keys(_classPrivateFieldLooseBase$6(this,_cfg$1)[_cfg$1]).length}get references(){var e=this;return new class{constructor(t){for(var s in this.self=_classPrivateFieldLooseBase$6(e,_context$3)[_context$3].self,t)"self"!==s&&(this[s]=NGN.coalesce(e.getReference(s,this.self)))}get length(){return e.length}add(){e.addReference(...arguments)}remove(){e.removeReference(...arguments)}get(){return e.getReference(...arguments)}has(){return e.hasReference(...arguments)}}(_classPrivateFieldLooseBase$6(this,_cfg$1)[_cfg$1])}addReference(e,t){if(_classPrivateFieldLooseBase$6(this,_referenceIsValid)[_referenceIsValid](...arguments))return _classPrivateFieldLooseBase$6(this,_cfg$1)[_cfg$1].hasOwnProperty(e)?console.error('Reference "'.concat(e,'" already exists')):void(_classPrivateFieldLooseBase$6(this,_cfg$1)[_cfg$1][e]=t)}removeReference(e){if(!_classPrivateFieldLooseBase$6(this,_cfg$1)[_cfg$1].hasOwnProperty(e))return console.error('Reference "'.concat(e,'" not found.'));delete _classPrivateFieldLooseBase$6(this,_cfg$1)[_cfg$1][e]}getReference(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return _classPrivateFieldLooseBase$6(this,_cfg$1)[_cfg$1].hasOwnProperty(e)?this.createReference(e,_classPrivateFieldLooseBase$6(this,_cfg$1)[_cfg$1][e],t):(console.error('Reference "'.concat(e,'" not found')),null)}createReference(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=this;class r extends Reference{constructor(e,t){super(t),Object.defineProperty(this,i,{writable:!0,value:void 0}),_classPrivateFieldLooseBase$6(this,i)[i]=e}on(e,t){if("object"===NGN.typeof(e))return this.pool(e);_classPrivateFieldLooseBase$6(a,_registerHandler)[_registerHandler](this.element,"on",...arguments),super.on(...arguments)}off(e,t){return"all"===e?this.offAll():t?(_classPrivateFieldLooseBase$6(a,_unregisterHandler)[_unregisterHandler](this.element,...arguments),void super.off(...arguments)):_classPrivateFieldLooseBase$6(a,_handlers)[_handlers].get(this.element).filter(t=>t.event===e).forEach(e=>{super.off(e.event,e.callback),_classPrivateFieldLooseBase$6(a,_unregisterHandler)[_unregisterHandler](this.element,e.event,e.callback)})}offAll(){_classPrivateFieldLooseBase$6(a,_handlers)[_handlers].get(this.element).forEach(e=>{super.off(e.event,e.callback)}),_classPrivateFieldLooseBase$6(a,_unregisterAllHandlers)[_unregisterAllHandlers](this.element)}once(e,t){var s=()=>{t(...arguments),this.off(e,s)};this.on(e,s)}pool(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var s in e)t?this.once(s,e[s]):this.on(s,e[s])}}var i=_classPrivateFieldLooseKey$6("name");if("self"===e&&!_classPrivateFieldLooseBase$6(this,_cfg$1)[_cfg$1].self)return new r(e,_classPrivateFieldLooseBase$6(this,_self)[_self]);var o=s?s.element.querySelectorAll(t):document.querySelectorAll(t);switch(o.length){case 0:return null;case 1:return new r(e,o[0]);default:return new JetReferenceCollection([...o].map((e,t)=>new r(t,e)))}}hasReference(e){return _classPrivateFieldLooseBase$6(this,_cfg$1)[_cfg$1].hasOwnProperty(e)}}var _context$3=_classPrivateFieldLooseKey$6("context"),_cfg$1=_classPrivateFieldLooseKey$6("cfg"),_self=_classPrivateFieldLooseKey$6("self"),_handlers=_classPrivateFieldLooseKey$6("handlers"),_reservedNames=_classPrivateFieldLooseKey$6("reservedNames"),_applyContext=_classPrivateFieldLooseKey$6("applyContext"),_referenceIsValid=_classPrivateFieldLooseKey$6("referenceIsValid"),_registerHandler=_classPrivateFieldLooseKey$6("registerHandler"),_unregisterHandler=_classPrivateFieldLooseKey$6("unregisterHandler"),_unregisterAllHandlers=_classPrivateFieldLooseKey$6("unregisterAllHandlers");function _classPrivateFieldLooseBase$7(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$7=0;function _classPrivateFieldLooseKey$7(e){return"__private_"+id$7+++"_"+e}class ReactionManager{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object.defineProperty(this,_context$4,{writable:!0,value:void 0}),Object.defineProperty(this,_reactions,{writable:!0,value:null}),Object.defineProperty(this,_parent,{writable:!0,value:void 0}),Object.defineProperty(this,_handleParentStateChange,{writable:!0,value:e=>{_classPrivateFieldLooseBase$7(this,_reactions)[_reactions]&&_classPrivateFieldLooseBase$7(this,_reactions)[_reactions].hasOwnProperty(e.current)&&(_classPrivateFieldLooseBase$7(this,_context$4)[_context$4].state=_classPrivateFieldLooseBase$7(this,_reactions)[_reactions][e.current])}}),_classPrivateFieldLooseBase$7(this,_context$4)[_context$4]=e,_classPrivateFieldLooseBase$7(this,_parent)[_parent]=NGN.coalesce(e.parent),_classPrivateFieldLooseBase$7(this,_reactions)[_reactions]=t}initialize(){var e=this;if(_classPrivateFieldLooseBase$7(this,_parent)[_parent]=_classPrivateFieldLooseBase$7(this,_context$4)[_context$4].parent,_classPrivateFieldLooseBase$7(this,_reactions)[_reactions]){var t=function(t){var s=_classPrivateFieldLooseBase$7(e,_reactions)[_reactions][t];if(Array.isArray(s))return console.error('Invalid reaction type "array"'),"continue";var a=typeof s;if("object"===a){var r=function(){var a=s,r=function(s){_classPrivateFieldLooseBase$7(e,_context$4)[_context$4].on("".concat(t,".state.changed"),t=>{if(t.current===s)switch(typeof a[s]){case"string":_classPrivateFieldLooseBase$7(e,_context$4)[_context$4].state=a[s];break;case"function":return a[s].call(_classPrivateFieldLooseBase$7(e,_context$4)[_context$4])}})};for(var i in a)r(i);return{v:{v:void 0}}}();if("object"==typeof r)return r.v}_classPrivateFieldLooseBase$7(e,_parent)[_parent]&&_classPrivateFieldLooseBase$7(e,_parent)[_parent].on("state.changed",r=>{if(r.current===t)switch(a){case"string":_classPrivateFieldLooseBase$7(e,_context$4)[_context$4].state=s;break;case"function":return s.call(_classPrivateFieldLooseBase$7(e,_context$4)[_context$4])}})};for(var s in _classPrivateFieldLooseBase$7(this,_reactions)[_reactions]){var a=t(s);switch(a){case"continue":continue;default:if("object"==typeof a)return a.v}}}}get hasParent(){return!!_classPrivateFieldLooseBase$7(this,_parent)[_parent]}set parent(e){this.hasParent&&_classPrivateFieldLooseBase$7(this,_parent)[_parent].off("state.changed",_classPrivateFieldLooseBase$7(this,_handleParentStateChange)[_handleParentStateChange]),e&&(_classPrivateFieldLooseBase$7(this,_parent)[_parent]=e,_classPrivateFieldLooseBase$7(this,_parent)[_parent].on("state.changed",_classPrivateFieldLooseBase$7(this,_handleParentStateChange)[_handleParentStateChange]))}}var _context$4=_classPrivateFieldLooseKey$7("context"),_reactions=_classPrivateFieldLooseKey$7("reactions"),_parent=_classPrivateFieldLooseKey$7("parent"),_handleParentStateChange=_classPrivateFieldLooseKey$7("handleParentStateChange");function _classPrivateFieldLooseBase$8(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$8=0;function _classPrivateFieldLooseKey$8(e){return"__private_"+id$8+++"_"+e}class TemplateInstance{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object.defineProperty(this,_namespace,{writable:!0,value:void 0}),Object.defineProperty(this,_referenceManager,{writable:!0,value:void 0}),Object.defineProperty(this,_renderFn,{writable:!0,value:void 0}),Object.defineProperty(this,_applyNamespace$1,{writable:!0,value:e=>"".concat(this.namespace,".").concat(e)}),this.parent=t,_classPrivateFieldLooseBase$8(this,_namespace)[_namespace]=NGN.coalesce(e.namespace,Utilities.createGUID()),_classPrivateFieldLooseBase$8(this,_renderFn)[_renderFn]=NGN.coalesce(e.render),_classPrivateFieldLooseBase$8(this,_referenceManager)[_referenceManager]=new ReferenceManager(this,NGN.coalesce(e.references))}get namespace(){return"".concat(this.parent?"".concat(this.parent.namespace,"."):"").concat(_classPrivateFieldLooseBase$8(this,_namespace)[_namespace])}get type(){return"template"}get references(){return _classPrivateFieldLooseBase$8(this,_referenceManager)[_referenceManager].references}get refs(){return this.references}emit(){arguments[0]=_classPrivateFieldLooseBase$8(this,_applyNamespace$1)[_applyNamespace$1](arguments[0]),NGN.BUS.emit(...arguments)}render(){var e=_classPrivateFieldLooseBase$8(this,_renderFn)[_renderFn]?_classPrivateFieldLooseBase$8(this,_renderFn)[_renderFn](...arguments):null;return e&&_classPrivateFieldLooseBase$8(this,_referenceManager)[_referenceManager].initialize(),e}}var _namespace=_classPrivateFieldLooseKey$8("namespace"),_referenceManager=_classPrivateFieldLooseKey$8("referenceManager"),_renderFn=_classPrivateFieldLooseKey$8("renderFn"),_applyNamespace$1=_classPrivateFieldLooseKey$8("applyNamespace"),Template=function(e){return{type:"template",namespace:NGN.coalesce(e.namespace),render:NGN.coalesce(e.render),references:NGN.coalesce(e.references)}};function _classPrivateFieldLooseBase$9(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$9=0;function _classPrivateFieldLooseKey$9(e){return"__private_"+id$9+++"_"+e}class VirtualNode{constructor(e){var{tag:t,attributes:s,on:a,children:r}=e;Object.defineProperty(this,_resolveClassList,{writable:!0,value:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.reduce((e,t)=>{switch(NGN.typeof(t)){case"object":return[...e,...Object.keys(t).filter(e=>!0===t[e])];case"number":case"string":return[...e,t]}},[]).join(" ")}}),this.tag=NGN.coalesce(t),s&&NGN.coalesce(s.class)&&"array"===NGN.typeof(s.class)&&(s.class=_classPrivateFieldLooseBase$9(this,_resolveClassList)[_resolveClassList](...s.class)),this.attributes=NGN.coalesce(s),this.listeners=NGN.coalesce(a,{}),this.children=NGN.coalesce(r,[]).filter(Boolean),this.interface=null}get hasAttributes(){return!!this.attributes&&Object.keys(this.attributes).length>0}get hasChildren(){return this.children.length>0}get hasListeners(){return!!this.listeners&&Object.keys(this.listeners).length>0}get isBound(){return!!this.interface}hasAttribute(e){return this.attributes.hasOwnProperty(e)}hasListener(e){return this.listeners.hasOwnProperty(e)}initialize(e,t){this.interface.initialize(e,t)}}var _resolveClassList=_classPrivateFieldLooseKey$9("resolveClassList");class Renderer{constructor(e){var t=this;Object.defineProperty(this,_context$5,{writable:!0,value:void 0}),Object.defineProperty(this,_cachedElements,{writable:!0,value:new Map}),Object.defineProperty(this,_parser,{writable:!0,value:new DOMParser}),Object.defineProperty(this,_trash,{writable:!0,value:[]}),Object.defineProperty(this,_boundNodes,{writable:!0,value:new Map}),Object.defineProperty(this,_addAttributes,{writable:!0,value:(e,t)=>{for(var s in t){var a=t[s];if("boolean"!=typeof a)e.setAttribute(s,_classPrivateFieldLooseBase$9(this,_parser)[_parser].parseFromString(a,"text/html").body.textContent);else{if(!a)continue;e.setAttribute(s,"")}}}}),Object.defineProperty(this,_removeAttributes,{writable:!0,value:(e,t)=>{if(t)for(var s in t)e.removeAttribute(s);else for(;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name)}}),Object.defineProperty(this,_addListeners,{writable:!0,value:(e,t)=>{for(var s in t)e.addEventListener(s,t[s])}}),Object.defineProperty(this,_removeListeners,{writable:!0,value:(e,t)=>{for(var s in t)e.removeEventListener(s,t[s])}}),Object.defineProperty(this,_appendChildNode,{writable:!0,value:(e,t)=>{e.appendChild(_classPrivateFieldLooseBase$9(this,_processVirtualNode)[_processVirtualNode](t))}}),Object.defineProperty(this,_appendChildNodes,{writable:!0,value:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0!==s.length&&s.forEach(s=>{null!=s&&_classPrivateFieldLooseBase$9(t,_appendChildNode)[_appendChildNode](e,s)})}}),Object.defineProperty(this,_clearChildNodes,{writable:!0,value:e=>{for(;e.lastChild;)e.removeChild(e.lastChild);return e}}),Object.defineProperty(this,_createNode,{writable:!0,value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e||"number"==typeof e){var s=_classPrivateFieldLooseBase$9(t,_parser)[_parser].parseFromString(e,"text/html").body.textContent;return document.createTextNode(s)}return document.createElement(e.tag)}}),Object.defineProperty(this,_nodeIsEmpty,{writable:!0,value:e=>[...e.childNodes].every(e=>3===e.nodeType&&!e.data.trim()||8===e.nodeType)}),Object.defineProperty(this,_parseElement,{writable:!0,value:e=>new VirtualNode({tag:e.localName,attributes:[...e.attributes].reduce((e,t)=>(e[t.name]=t.value,e),{}),children:e.childNodes.length>0?[...e.childNodes].map(e=>{switch(e.nodeType){case 1:return _classPrivateFieldLooseBase$9(this,_parseElement)[_parseElement](e);case 3:return e.data;default:return null}}):[]})}),Object.defineProperty(this,_processChildren,{writable:!0,value:e=>{if("array"!==NGN.typeof(e))throw new Error("Children must be an array");return e.reduce((e,t)=>{if(!t)return e;if(t instanceof VirtualNode)return[...e,t];var s=NGN.typeof(t);switch(s){case"string":case"number":return[...e,"".concat(t)];case"object":return"CustomElement"===t.constructor.name?[...e,..._classPrivateFieldLooseBase$9(this,_processCustomElement)[_processCustomElement](t)]:[...e,..._classPrivateFieldLooseBase$9(this,_processTemplate)[_processTemplate](t)]}if("array"!==s)throw new Error('Invalid child element type "'.concat(typeof t,'"'));if("object"===(s=NGN.typeof(t[0])))return[...e,..._classPrivateFieldLooseBase$9(this,_processTemplate)[_processTemplate](t[0],t.slice(1))];var a=this.createVirtualNode(...t);return a.children.length>0&&(a.children=_classPrivateFieldLooseBase$9(this,_processChildren)[_processChildren](a.children)),[...e,a]},[])}}),Object.defineProperty(this,_processCustomElement,{writable:!0,value:e=>(console.log(e),_classPrivateFieldLooseBase$9(this,_processChildren)[_processChildren]([[e.tag]]))}),Object.defineProperty(this,_processTemplate,{writable:!0,value:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=new TemplateInstance(e,_classPrivateFieldLooseBase$9(t,_context$5)[_context$5]);return _classPrivateFieldLooseBase$9(t,_processChildren)[_processChildren](a.render(...s))}}),Object.defineProperty(this,_processVirtualNode,{writable:!0,value:e=>{var t=_classPrivateFieldLooseBase$9(this,_createNode)[_createNode](e);if(e.hasAttributes)for(var s in e.attributes){var a=e.attributes[s],r=NGN.typeof(a);"boolean"===r?a?t.setAttribute(s,""):t.removeAttribute(s):t.setAttribute(s,"function"===r?a():_classPrivateFieldLooseBase$9(this,_parser)[_parser].parseFromString(a,"text/html").body.textContent)}if(e.hasListeners)for(var i in e.listeners)t.addEventListener(i,e.listeners[i]);return e.hasChildren&&_classPrivateFieldLooseBase$9(this,_appendChildNodes)[_appendChildNodes](t,e.children),e.isBound&&_classPrivateFieldLooseBase$9(this,_boundNodes)[_boundNodes].set(e,t),t}}),Object.defineProperty(this,_reconcileAttributes,{writable:!0,value:(e,t)=>{if(t.new.hasAttributes&&!t.old.hasAttributes)return _classPrivateFieldLooseBase$9(this,_addAttributes)[_addAttributes](e,t.new.attributes);if(!t.new.hasAttributes&&t.old.hasAttributes)return _classPrivateFieldLooseBase$9(this,_removeAttributes)[_removeAttributes](e,t.old.attributes);for(var s in Object.assign({},t.new.attributes,t.old.attributes)){var a=t.new.hasAttribute(s),r=a&&t.old.hasAttribute(s);if(!r||t.new.attributes[s]!==t.old.attributes[s])if(r||a){var i=t.new.attributes[s];"boolean"==typeof i?i?e.setAttribute(s,""):e.removeAttribute(s):e.setAttribute(s,_classPrivateFieldLooseBase$9(this,_parser)[_parser].parseFromString(i,"text/html").body.textContent)}else e.removeAttribute(s)}}}),Object.defineProperty(this,_reconcileListeners,{writable:!0,value:(e,t)=>{if(t.new.hasListeners&&!t.old.hasListeners)return _classPrivateFieldLooseBase$9(this,_addListeners)[_addListeners](e,t.new.listeners);if(!t.new.hasListeners&&t.old.hasListeners)return _classPrivateFieldLooseBase$9(this,_removeListeners)[_removeListeners](e,t.old.listeners);for(var s in Object.assign({},t.new.listeners,t.old.listeners)){var a=t.new.hasListener(s),r=a&&t.old.hasListener(s);r&&t.new.listeners[s]===t.old.listeners[s]||(r&&e.removeEventListener(s,t.old.listeners[s]),a&&e.addEventListener(s,t.new.listeners[s]))}}}),Object.defineProperty(this,_reconcileChildNodes,{writable:!0,value:(e,t,s)=>{for(var a=0;a<Math.max(t.length,s.length);a++)_classPrivateFieldLooseBase$9(this,_reconcileNodes)[_reconcileNodes]({target:e,state:{old:NGN.coalesce(s[a]),new:NGN.coalesce(t[a])},index:a});_classPrivateFieldLooseBase$9(this,_trash)[_trash].reduce((e,t)=>t.remove(),[])}}),Object.defineProperty(this,_reconcileNodes,{writable:!0,value:e=>{var{target:t,state:s={old:null,new:null},index:a=0}=e,r=t.childNodes[a];if(s.new){if(!r)return _classPrivateFieldLooseBase$9(this,_appendChildNode)[_appendChildNode](t,s.new);var i=NGN.typeof(s.new);return i!==typeof s.old||"string"===i?_classPrivateFieldLooseBase$9(this,_replaceChildNode)[_replaceChildNode](t,r,s.new):"object"!==i?console.error("Invalid rendering configuration."):s.new.tag!==s.old.tag?_classPrivateFieldLooseBase$9(this,_replaceChildNode)[_replaceChildNode](t,r,s.new):(_classPrivateFieldLooseBase$9(this,_reconcileChildNodes)[_reconcileChildNodes](r,s.new.children,s.old.children),_classPrivateFieldLooseBase$9(this,_reconcileAttributes)[_reconcileAttributes](r,s),_classPrivateFieldLooseBase$9(this,_reconcileListeners)[_reconcileListeners](r,s),void(s.new.isBound&&s.new.initialize(_classPrivateFieldLooseBase$9(this,_context$5)[_context$5],r)))}r&&_classPrivateFieldLooseBase$9(this,_trash)[_trash].push(r)}}),Object.defineProperty(this,_replaceChildNode,{writable:!0,value:(e,t,s)=>{e.replaceChild(_classPrivateFieldLooseBase$9(this,_processVirtualNode)[_processVirtualNode](s),t)}}),Object.defineProperty(this,_renderHTML,{writable:!0,value:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new Promise((a,r)=>{if("string"==typeof s)return e.innerHTML=s,a(e);if(0===s.length)return a(e=_classPrivateFieldLooseBase$9(t,_clearChildNodes)[_clearChildNodes](e));var i=_classPrivateFieldLooseBase$9(t,_cachedElements)[_cachedElements].get(e);i.hasChildren?_classPrivateFieldLooseBase$9(t,_reconcileChildNodes)[_reconcileChildNodes](e,s,i.children):_classPrivateFieldLooseBase$9(t,_appendChildNodes)[_appendChildNodes](e,s),i.children=s,_classPrivateFieldLooseBase$9(t,_boundNodes)[_boundNodes].forEach((e,s)=>s.initialize(_classPrivateFieldLooseBase$9(t,_context$5)[_context$5],e)),_classPrivateFieldLooseBase$9(t,_boundNodes)[_boundNodes].clear(),a(e)})}}),_classPrivateFieldLooseBase$9(this,_context$5)[_context$5]=e}createVirtualNode(){if(0===arguments.length||!(arguments.length<=0?void 0:arguments[0]))throw new Error("Cannot create element: Invalid Configuration.");var e=NGN.typeof(arguments.length<=0?void 0:arguments[0]);if("object"===e)return new VirtualNode(arguments.length<=0?void 0:arguments[0]);if("string"!==e)throw new Error("Cannot create element: Invalid Configuration.");var t={tag:arguments.length<=0?void 0:arguments[0],attributes:null,on:null,children:null};if(arguments.length>=2)switch(NGN.typeof(arguments.length<=1?void 0:arguments[1])){case"object":t.attributes=arguments.length<=1?void 0:arguments[1];break;case"array":t.children=_classPrivateFieldLooseBase$9(this,_processChildren)[_processChildren](arguments.length<=1?void 0:arguments[1])}if(arguments.length>=3)switch(NGN.typeof(arguments.length<=2?void 0:arguments[2])){case"object":t.on=arguments.length<=2?void 0:arguments[2];break;case"array":t.children=_classPrivateFieldLooseBase$9(this,_processChildren)[_processChildren](arguments.length<=2?void 0:arguments[2])}return arguments.length>=4&&(t.children=_classPrivateFieldLooseBase$9(this,_processChildren)[_processChildren](arguments.length<=3?void 0:arguments[3])),new VirtualNode(t)}clearCache(){_classPrivateFieldLooseBase$9(this,_cachedElements)[_cachedElements].clear()}generateHTML(e){var t=document.createElement("div");return _classPrivateFieldLooseBase$9(this,_appendChildNodes)[_appendChildNodes](t,_classPrivateFieldLooseBase$9(this,_processChildren)[_processChildren](e)),t.innerHTML}render(e,t){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e instanceof VirtualNode||"array"===NGN.typeof(e)){var{self:r}=_classPrivateFieldLooseBase$9(this,_context$5)[_context$5];if(!r.element)throw new Error("Cannot render because Interface has no self-reference");t=e,e=r.element}else if(e.hasOwnProperty("element")&&e.element instanceof HTMLElement)e=e.element;else if(!(e instanceof HTMLElement))throw new Error("Invalid target element");return(s||_classPrivateFieldLooseBase$9(this,_nodeIsEmpty)[_nodeIsEmpty](e)&&e.childNodes.length>0)&&(e=_classPrivateFieldLooseBase$9(this,_clearChildNodes)[_clearChildNodes](e)),_classPrivateFieldLooseBase$9(this,_cachedElements)[_cachedElements].has(e)||_classPrivateFieldLooseBase$9(this,_cachedElements)[_cachedElements].set(e,_classPrivateFieldLooseBase$9(this,_parseElement)[_parseElement](e)),a?new Promise((s,a)=>(_classPrivateFieldLooseBase$9(this,_appendChildNodes)[_appendChildNodes](e,_classPrivateFieldLooseBase$9(this,_processChildren)[_processChildren](t)),s(e))):_classPrivateFieldLooseBase$9(this,_renderHTML)[_renderHTML](e,_classPrivateFieldLooseBase$9(this,_processChildren)[_processChildren](t))}replace(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.render(...t,!0)}}var _context$5=_classPrivateFieldLooseKey$9("context"),_cachedElements=_classPrivateFieldLooseKey$9("cachedElements"),_parser=_classPrivateFieldLooseKey$9("parser"),_trash=_classPrivateFieldLooseKey$9("trash"),_boundNodes=_classPrivateFieldLooseKey$9("boundNodes"),_addAttributes=_classPrivateFieldLooseKey$9("addAttributes"),_removeAttributes=_classPrivateFieldLooseKey$9("removeAttributes"),_addListeners=_classPrivateFieldLooseKey$9("addListeners"),_removeListeners=_classPrivateFieldLooseKey$9("removeListeners"),_appendChildNode=_classPrivateFieldLooseKey$9("appendChildNode"),_appendChildNodes=_classPrivateFieldLooseKey$9("appendChildNodes"),_clearChildNodes=_classPrivateFieldLooseKey$9("clearChildNodes"),_createNode=_classPrivateFieldLooseKey$9("createNode"),_nodeIsEmpty=_classPrivateFieldLooseKey$9("nodeIsEmpty"),_parseElement=_classPrivateFieldLooseKey$9("parseElement"),_processChildren=_classPrivateFieldLooseKey$9("processChildren"),_processCustomElement=_classPrivateFieldLooseKey$9("processCustomElement"),_processTemplate=_classPrivateFieldLooseKey$9("processTemplate"),_processVirtualNode=_classPrivateFieldLooseKey$9("processVirtualNode"),_reconcileAttributes=_classPrivateFieldLooseKey$9("reconcileAttributes"),_reconcileListeners=_classPrivateFieldLooseKey$9("reconcileListeners"),_reconcileChildNodes=_classPrivateFieldLooseKey$9("reconcileChildNodes"),_reconcileNodes=_classPrivateFieldLooseKey$9("reconcileNodes"),_replaceChildNode=_classPrivateFieldLooseKey$9("replaceChildNode"),_renderHTML=_classPrivateFieldLooseKey$9("renderHTML");function _classPrivateFieldLooseBase$a(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$a=0;function _classPrivateFieldLooseKey$a(e){return"__private_"+id$a+++"_"+e}class Interface{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.defineProperty(this,_cfg$2,{writable:!0,value:void 0}),Object.defineProperty(this,_parent$1,{writable:!0,value:void 0}),Object.defineProperty(this,_id$1,{writable:!0,value:Utilities.createGUID()}),Object.defineProperty(this,_namespace$1,{writable:!0,value:void 0}),Object.defineProperty(this,_selector,{writable:!0,value:void 0}),Object.defineProperty(this,_children,{writable:!0,value:void 0}),Object.defineProperty(this,_eventManager,{writable:!0,value:void 0}),Object.defineProperty(this,_propertyManager,{writable:!0,value:void 0}),Object.defineProperty(this,_referenceManager$1,{writable:!0,value:void 0}),Object.defineProperty(this,_stateManager,{writable:!0,value:void 0}),Object.defineProperty(this,_reactionManager,{writable:!0,value:void 0}),Object.defineProperty(this,_renderer,{writable:!0,value:new Renderer(this)}),Object.defineProperty(this,_initialized,{writable:!0,value:!1}),Object.defineProperty(this,_wasVisible,{writable:!0,value:null}),Object.defineProperty(this,_wasCompletelyVisible,{writable:!0,value:null}),this.boundData=null,Object.defineProperty(this,_handleScroll,{writable:!0,value:e=>{this.isCompletelyVisible?_classPrivateFieldLooseBase$a(this,_wasCompletelyVisible)[_wasCompletelyVisible]||this.emit("entered-viewport"):this.isVisible?(_classPrivateFieldLooseBase$a(this,_wasCompletelyVisible)[_wasCompletelyVisible]&&this.emit("exiting-viewport"),_classPrivateFieldLooseBase$a(this,_wasVisible)[_wasVisible]||this.emit("entering-viewport")):_classPrivateFieldLooseBase$a(this,_wasVisible)[_wasVisible]&&this.emit("exited-viewport"),_classPrivateFieldLooseBase$a(this,_wasVisible)[_wasVisible]=this.isVisible,_classPrivateFieldLooseBase$a(this,_wasCompletelyVisible)[_wasCompletelyVisible]=this.isCompletelyVisible}}),_classPrivateFieldLooseBase$a(this,_cfg$2)[_cfg$2]=e,_classPrivateFieldLooseBase$a(this,_namespace$1)[_namespace$1]=NGN.coalesce(e.namespace,_classPrivateFieldLooseBase$a(this,_id$1)[_id$1]),_classPrivateFieldLooseBase$a(this,_selector)[_selector]=NGN.coalesce(e.selector),_classPrivateFieldLooseBase$a(this,_children)[_children]=NGN.coalesce(e.children),_classPrivateFieldLooseBase$a(this,_eventManager)[_eventManager]=new EventManager(this,e),_classPrivateFieldLooseBase$a(this,_propertyManager)[_propertyManager]=new PropertyManager(this,NGN.coalesce(e.properties)),_classPrivateFieldLooseBase$a(this,_stateManager)[_stateManager]=new StateManager(this,NGN.coalesce(e.states),NGN.coalesce(e.initialState)),_classPrivateFieldLooseBase$a(this,_referenceManager$1)[_referenceManager$1]=new ReferenceManager(this,NGN.coalesce(e.references)),_classPrivateFieldLooseBase$a(this,_reactionManager)[_reactionManager]=new ReactionManager(this,NGN.coalesce(e.reactions))}get config(){return _classPrivateFieldLooseBase$a(this,_cfg$2)[_cfg$2]}get parent(){return _classPrivateFieldLooseBase$a(this,_parent$1)[_parent$1]}get selector(){return _classPrivateFieldLooseBase$a(this,_selector)[_selector]?_classPrivateFieldLooseBase$a(this,_selector)[_selector].startsWith("#")?this.selector:"".concat(this.parent?"".concat(this.parent.selector," "):"").concat(_classPrivateFieldLooseBase$a(this,_selector)[_selector]):null}get namespace(){return"".concat(this.parent?"".concat(this.parent.namespace,"."):"").concat(_classPrivateFieldLooseBase$a(this,_namespace$1)[_namespace$1])}get properties(){return _classPrivateFieldLooseBase$a(this,_propertyManager)[_propertyManager].properties}get props(){return this.properties}get self(){return _classPrivateFieldLooseBase$a(this,_referenceManager$1)[_referenceManager$1].getReference("self")}get state(){return _classPrivateFieldLooseBase$a(this,_stateManager)[_stateManager].current?_classPrivateFieldLooseBase$a(this,_stateManager)[_stateManager].current.name:null}set state(e){_classPrivateFieldLooseBase$a(this,_stateManager)[_stateManager].current=e}get states(){return _classPrivateFieldLooseBase$a(this,_stateManager)[_stateManager].states}get references(){return _classPrivateFieldLooseBase$a(this,_referenceManager$1)[_referenceManager$1].references}get refs(){return this.references}get type(){return"interface"}get isVisible(){return Utilities.elementIsVisible(this.self.element,!0)}get isCompletelyVisible(){return Utilities.elementIsVisible(this.self.element)}initialize(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=new NGN.Tasks;s.on("complete",()=>{_classPrivateFieldLooseBase$a(this,_initialized)[_initialized]=!0,this.emit("initialized")}),s.add("Initializing Renderer",e=>{_classPrivateFieldLooseBase$a(this,_renderer)[_renderer].clearCache(),e()}),s.add("Initializing Properties",e=>{_classPrivateFieldLooseBase$a(this,_propertyManager)[_propertyManager].initialize(),e()}),_classPrivateFieldLooseBase$a(this,_initialized)[_initialized]||(s.add("Connecting Parent Interface",t=>{_classPrivateFieldLooseBase$a(this,_parent$1)[_parent$1]=NGN.coalesce(e,_classPrivateFieldLooseBase$a(this,_parent$1)[_parent$1]),t()}),s.add("Initializing Event Bus",e=>{_classPrivateFieldLooseBase$a(this,_eventManager)[_eventManager].initialize(),e()}),s.add("Initializing Reactions",e=>{_classPrivateFieldLooseBase$a(this,_reactionManager)[_reactionManager].initialize(),e()})),s.add("Initializing References",e=>{_classPrivateFieldLooseBase$a(this,_referenceManager$1)[_referenceManager$1].initialize(t),e()}),s.add("Firing Hook Events",e=>{this.emit("initialize"),e()}),!_classPrivateFieldLooseBase$a(this,_initialized)[_initialized]&&_classPrivateFieldLooseBase$a(this,_children)[_children]&&s.add("Initializing Children",e=>{_classPrivateFieldLooseBase$a(this,_children)[_children].forEach(e=>e.initialize(this)),e()}),s.add("Initializing State Machine",e=>{_classPrivateFieldLooseBase$a(this,_stateManager)[_stateManager].initialize(),e()}),s.run(!0)}bind(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.boundData=t;var s=_classPrivateFieldLooseBase$a(this,_renderer)[_renderer].createVirtualNode(...e);return s.interface=this,s}emit(){_classPrivateFieldLooseBase$a(this,_eventManager)[_eventManager].emit(...arguments)}on(){_classPrivateFieldLooseBase$a(this,_eventManager)[_eventManager].on(...arguments)}off(){_classPrivateFieldLooseBase$a(this,_eventManager)[_eventManager].off(...arguments)}once(){_classPrivateFieldLooseBase$a(this,_eventManager)[_eventManager].once(...arguments)}pool(){_classPrivateFieldLooseBase$a(this,_eventManager)[_eventManager].pool(...arguments)}addState(e,t){_classPrivateFieldLooseBase$a(this,_stateManager)[_stateManager].add(...arguments)}removeState(e){_classPrivateFieldLooseBase$a(this,_stateManager)[_stateManager].remove(...arguments)}hasState(e){return _classPrivateFieldLooseBase$a(this,_stateManager)[_stateManager].has(...arguments)}setState(e,t,s){_classPrivateFieldLooseBase$a(this,_stateManager)[_stateManager].setState(...arguments)}transition(e,t,s){_classPrivateFieldLooseBase$a(this,_stateManager)[_stateManager].transition(...arguments)}addReference(e,t){_classPrivateFieldLooseBase$a(this,_referenceManager$1)[_referenceManager$1].add(...arguments)}removeReference(e){_classPrivateFieldLooseBase$a(this,_referenceManager$1)[_referenceManager$1].remove(...arguments)}destroy(){this.self.element.parentNode.removeChild(this.self.element)}enableScrollMonitor(){_classPrivateFieldLooseBase$a(this,_wasVisible)[_wasVisible]=this.isVisible,_classPrivateFieldLooseBase$a(this,_wasCompletelyVisible)[_wasCompletelyVisible]=this.isCompletelyVisible,window.addEventListener("scroll",e=>_classPrivateFieldLooseBase$a(this,_handleScroll)[_handleScroll](e))}disableScrollMonitor(){_classPrivateFieldLooseBase$a(this,_wasVisible)[_wasVisible]=null,_classPrivateFieldLooseBase$a(this,_wasCompletelyVisible)[_wasCompletelyVisible]=null,window.removeEventListener("scroll",e=>_classPrivateFieldLooseBase$a(this,_handleScroll)[_handleScroll](e))}appendHTML(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.renderHTML(e,t,!1,!0)}generateHTML(e){return _classPrivateFieldLooseBase$a(this,_renderer)[_renderer].generateHTML(e)}replaceHTML(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.renderHTML(e,t,!0)}renderHTML(){return _classPrivateFieldLooseBase$a(this,_renderer)[_renderer].render(...arguments)}}var _cfg$2=_classPrivateFieldLooseKey$a("cfg"),_parent$1=_classPrivateFieldLooseKey$a("parent"),_id$1=_classPrivateFieldLooseKey$a("id"),_namespace$1=_classPrivateFieldLooseKey$a("namespace"),_selector=_classPrivateFieldLooseKey$a("selector"),_children=_classPrivateFieldLooseKey$a("children"),_eventManager=_classPrivateFieldLooseKey$a("eventManager"),_propertyManager=_classPrivateFieldLooseKey$a("propertyManager"),_referenceManager$1=_classPrivateFieldLooseKey$a("referenceManager"),_stateManager=_classPrivateFieldLooseKey$a("stateManager"),_reactionManager=_classPrivateFieldLooseKey$a("reactionManager"),_renderer=_classPrivateFieldLooseKey$a("renderer"),_initialized=_classPrivateFieldLooseKey$a("initialized"),_wasVisible=_classPrivateFieldLooseKey$a("wasVisible"),_wasCompletelyVisible=_classPrivateFieldLooseKey$a("wasCompletelyVisible"),_handleScroll=_classPrivateFieldLooseKey$a("handleScroll"),JET={};NGN?(JET.EventEmitter=NGN.EventEmitter,JET.Utilities=Utilities,JET.Bus=NGN.BUS,JET.Interface=Interface,JET.Template=Template,JET.ready=function(e){document.addEventListener("DOMContentLoaded",(function t(){e(),document.removeEventListener("DOMContentLoaded",t)}))}):console.error("Jet requires NGN. See https://github.com/ngnjs/NGN"),Object.freeze(JET),window.JET=JET;export default JET;